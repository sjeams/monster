{"version":3,"sources":["assets\\Script\\login\\myserver.js"],"names":["HttpHelper","require","cc","Class","Component","properties","editbox","EditBox","onLoad","btnClick1","event","customEventData","params","sys","localStorage","setItem","serverid","httpRequest","httpPost","data","log","code","userinfo","callback","director","loadScene","start"],"mappings":";;;;;;AACA,IAAIA,UAAU,GAAGC,OAAO,CAAC,MAAD,CAAxB,EACA;;;AAEAC,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,OAAO,EAAEJ,EAAE,CAACK;AADJ,GAHP;AAOLC,EAAAA,MAAM,EAAE,kBAAY,CAChB;AAGA;AACA;AACA;AACA;AACH,GAfI;AAiBLC,EAAAA,SAAS,EAAE,mBAAUC,KAAV,EAAiBC,eAAjB,EAAkC;AAEzC;AACA,QAAIC,MAAM,GAAG;AACL,mBAAa,YADR;AAEL,kBAAY,MAFP;AAGL,kBAAY;AAHP,KAAb;AAMAV,IAAAA,EAAE,CAACW,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4BC,QAA5B,EAAqCJ,MAAM,CAACI,QAA5C,EATyC,CASc;;AACvD,QAAIC,WAAW,GAAI,IAAIjB,UAAJ,EAAnB;AACAiB,IAAAA,WAAW,CAACC,QAAZ,CAAqB,kDAArB,EAAyEN,MAAzE,EAAiF,UAAUO,IAAV,EAAgB;AAC7FjB,MAAAA,EAAE,CAACkB,GAAH,CAAOD,IAAP;;AACA,UAAGA,IAAI,CAACE,IAAL,IAAW,CAAd,EAAgB,CAAE;AACd;AACH;;AACD,UAAGF,IAAI,CAACE,IAAL,IAAW,CAAd,EAAgB;AAAC;AACbnB,QAAAA,EAAE,CAACkB,GAAH,CAAOD,IAAI,CAACA,IAAL,CAAUG,QAAjB;AACApB,QAAAA,EAAE,CAACW,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4BO,QAA5B,EAAqCH,IAAI,CAACA,IAAL,CAAUG,QAA/C,EAFY,CAE8C;AAC1D;AACH;;AACD,UAAGH,IAAI,CAACE,IAAL,IAAW,CAAd,EAAgB,CAAE;AACd;AACH;AACJ,KAbD,EAXyC,CA0BzC;AACA;AACA;AACA;AACA;AACH,GAhDI;AAkDLE,EAAAA,QAAQ,EAAE,kBAAUb,KAAV,EAAiB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACQR,IAAAA,EAAE,CAACsB,QAAH,CAAYC,SAAZ,CAAsB,KAAtB,EArBe,CAsBvB;AACA;AACA;AACA;AAEH,GA7EI;AA+ELC,EAAAA,KA/EK,mBA+EI,CAER,CAjFI,CAmFL;;AAnFK,CAAT","sourceRoot":"/","sourcesContent":["\r\nvar HttpHelper = require(\"http\");\r\n// var globaluserinfo = require(\"GlobaluserInfo\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n \r\n    properties: {\r\n        editbox: cc.EditBox\r\n    },\r\n \r\n    onLoad: function () {\r\n        // var button =  cc.find(\"Canvas/login\").on('click', this.callback, this);\r\n\r\n\r\n        //储存缓存\r\n        // cc.sys.localStorage.setItem('token', value);\r\n        // cc.sys.localStorage.getItem(key);\r\n        // cc.sys.localStorage.removeItem(key);\r\n    },\r\n     \r\n    btnClick1: function (event, customEventData) {\r\n\r\n        // 请求登录接口\r\n        var params = {\r\n                'loginname': 'yincan1993',\r\n                'password': 123456,\r\n                'serverid': 1,\r\n        };\r\n\r\n        cc.sys.localStorage.setItem(serverid,params.serverid); //存储数据  --当前服务器\r\n        let httpRequest =  new HttpHelper();  \r\n        httpRequest.httpPost('http://www.monster.com/app/api-server/user-login', params ,function (data) {\r\n            cc.log(data); \r\n            if(data.code==0){ // 登录失败，或本地数据失效\r\n                // 弹窗\r\n            }\r\n            if(data.code==1){// 登录成功，进入游戏\r\n                cc.log(data.data.userinfo); \r\n                cc.sys.localStorage.setItem(userinfo,data.data.userinfo); //存储数据\r\n                // cc.sys.localStorage.getItem(key); //读取数据\r\n            }\r\n            if(data.code==2){ // 登录成功，未定义角色\r\n                // 进入定义角色界面     \r\n            }\r\n        });\r\n        \r\n        //这里 event 是一个 Touch Event 对象，你可以通过 event.target 取到事件的发送节点\r\n        // var node = event.target;\r\n        // var button = node.getComponent(cc.Button);\r\n        //这里的 customEventData 参数就等于你之前设置的 \"click1 user data\"\r\n        // cc.log(\"node=\", node.name, \" event=\", event.type, \" data=\", customEventData);\r\n    },\r\n\r\n    callback: function (event) {\r\n        // cc.log(data)\r\n        // var userCount =  cc.find(\"Canvas/ground/editbox_count\").getComponent(cc.EditBox).string;\r\n        // var userPassward =  cc.find(\"Canvas/ground/editbox_passward\").getComponent(cc.EditBox).string;\r\n        // console.log(\"用户账号：\"+userCount+ \"用户密码：\"+ userPassward);\r\n        // HttpHelp.login(userCount,userPassward,function(isSuccess,Data){\r\n        //     var info = Data;\r\n        //     if(true == isSuccess){\r\n        //         console.log(\"login  success!!!\");\r\n        //         console.log(info);\r\n        //         globaluserinfo.username = info.username;\r\n        //         globaluserinfo.gamepoint = info.gamepoint;\r\n        //         globaluserinfo.skey = info.skey;\r\n        //         globaluserinfo.userid = info.userid;\r\n \r\n        //         globaluserinfo.money = info.money;\r\n        //         globaluserinfo.userid = info.userid;\r\n        //         globaluserinfo.password = info.password;\r\n        //         globaluserinfo.salt = info.salt;\r\n \r\n        //         //登录成功后加载地图资源\r\n                cc.director.loadScene('map');\r\n        //     }else{\r\n        //         console.log(\"login  filed!!!\")\r\n        //     }\r\n        // });\r\n        \r\n    },\r\n \r\n    start () {\r\n \r\n    },\r\n \r\n    // update (dt) {},\r\n});\r\n"]}