{"version":3,"sources":["loading.js"],"names":["self","cc","Class","extends","Component","properties","speed","progressBar","default","type","ProgressBar","text","Sprite","audio","AudioClip","play","audioSource","pause","bmp_font","Label","onLoad","console","log","node","_urls","url","resource","progress","string","_clearAll","loader","load","_progressCallback","bind","_completeCallback","start","i","length","release","completeCount","totalCount","res","sys_label","getChildByName","getComponent","parseInt","current","audioEngine","err","texture","update","dt","active","enabled","loadnextScene","director","preloadScene","loadScene"],"mappings":"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","file":"loading.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\login","sourcesContent":["var self = this;\r\ncc.Class({\r\n    extends: cc.Component,\r\n \r\n    properties: {\r\n        speed: 1,\r\n        progressBar:{\r\n            default:null,\r\n            type:cc.ProgressBar,\r\n            text:cc.Sprite,\r\n        },\r\n        audio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        play: function () {\r\n            this.audioSource.play();\r\n        },\r\n        \r\n        pause: function () {\r\n            this.audioSource.pause();\r\n        },\r\n        bmp_font: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        // //默认头像\r\n        // headpic:{\r\n        //     type:cc.SpriteFrame,\r\n        //     default:null,\r\n        // },\r\n        //头像\r\n        // background:{\r\n        //     default:null,\r\n        //     type:cc.Sprite,\r\n        // },\r\n    },\r\n\r\n        \r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n \r\n    onLoad () {\r\n        console.log(this.node);\r\n            console.log('正在对比资源');\r\n            // // 远程 url 不带图片后缀名，此时必须指定远程图片文件的类型\r\n            // remoteUrl = \"http://unknown.org/emoji?id=124982374\";\r\n            // cc.loader.load({url: remoteUrl, type: 'png'}, function () {\r\n            //     // Use texture to create sprite frame\r\n            // });\r\n            \r\n            // // 用绝对路径加载设备存储内的资源，比如相册\r\n            // var absolutePath = \"/dara/data/some/path/to/image.png\"\r\n            // cc.loader.load(absolutePath, function () {\r\n            //     // Use texture to create sprite frame\r\n            // });\r\n            console.log('正在加载场景资源，请耐心等待...');\r\n        // 加载资源包\r\n        this._urls = [\r\n            {url:'http://www.monster.com/app/api/file-content?url=http://www.monster.com/app/loading/剑指苍茫.mp3', type:'mp3'},\r\n            {url:'http://www.monster.com/app/api/file-content?url=http://www.monster.com/app/loading/loading.jpg', type:'jpg'},\r\n            // {url:'http://www.monster.com/app/api/file-content?url=http://127.0.0.1/123.jpg', type:'jpg'},\r\n            // {url:'http://www.monster.com/app/api/file-content?url=http://127.0.0.1/ccc.png', type:'png'},\r\n            {url:'http://www.monster.com/app/api/file-content?url=http://127.0.0.1/jq22honey.zip', type:'zip'},\r\n            // {url:'http://www.monster.com/app/api/file-content?url=http://127.0.0.1/monster.zip', type:'zip'},\r\n            // {url:'http://www.monster.com/app/api/file-content?url=http://127.0.0.1（这里填你的服务器ip)/image2.png', type:'png'}, \r\n        ];\r\n\r\n        console.log( this.progressBar); \r\n        // console.log( this.sprite); \r\n        this.resource = null;\r\n        this.progressBar.progress =0;\r\n\r\n        this.bmp_font.string = \"0%\";\r\n\r\n\r\n  \r\n        // this.ProgressBar.progress += math_random / 100; \r\n        this._clearAll();\r\n       \r\n        cc.loader.load(this._urls, this._progressCallback.bind(this), this._completeCallback.bind(this));\r\n    },\r\n \r\n    start () {\r\n\r\n    },\r\n \r\n    _clearAll: function() {\r\n        for(var i = 0; i < this._urls.length; ++i) {\r\n            var url = this._urls[i];\r\n            cc.loader.release(url);\r\n        }\r\n    },\r\n \r\n    _progressCallback: function(completeCount, totalCount, res) {\r\n        //加载进度回调\r\n        // console.log('资源 ' + completeCount + '加载完成！资源加载中...');\r\n        // console.log('加载场景资源');\r\n        this.progress = completeCount / totalCount;\r\n        this.resource = res;\r\n        this.completeCount = completeCount;\r\n        this.totalCount = totalCount;\r\n\r\n        // 代码里面获取cc.Label组件, 修改文本内容\r\n        //在代码里面获取cc.Label组件\r\n        var sys_label = this.node.getChildByName(\"sys_label\").getComponent(cc.Label);\r\n        sys_label.string = parseInt(this.progress * 100) + '%';\r\n\r\n        if( this.resource.type=='json'){\r\n            // console.log(this.resource);  // json\r\n            // 从服务器加载mp3来进行播放\r\n            // this.audio.clip = ret;\r\n            // this.audio.play();\r\n        }\r\n        if( this.resource.type=='png'||this.resource.type=='jpg'){\r\n             console.log(res);  // json\r\n            //res是cc.Texture2D这样对象 \r\n            //   this.node.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(res)\r\n            // this.headpic.spriteFrame.setTexture(res);\r\n            // this.node.spriteFrame.setTexture(res);\r\n            // this.sprite.spriteFrame.setContentSize(res.getContentSize());\r\n            // this.node.getComponent(cc.Sprite).spriteFrame = res;\r\n        }\r\n        if( this.resource.type=='mp3'){\r\n            console.log(res);  // mp3\r\n            // this.audio.clip = res;\r\n            // this.audio.play();\r\n            // 从服务器加载mp3来进行播放\r\n            this.current = cc.audioEngine.play(res.url, false, 1);\r\n        }\r\n\r\n\r\n    },\r\n \r\n    _completeCallback: function(err, texture) {\r\n        //加载完成回调\r\n        // this.loadnextScene();  // 下一场景 \r\n    },\r\n \r\n    update (dt) {\r\n        if(!this.resource){\r\n            return ;\r\n        }\r\n        var progress = this.progressBar.progress;\r\n        if(progress >= 1){\r\n            console.log('加载完成')\r\n            //加载完成\r\n            this.progressBar.node.active = false; //进度条隐藏\r\n            this.bmp_font.node.active = false;  // 进度隐藏\r\n            this.enabled = false;\r\n            return ;\r\n        }\r\n \r\n        if(progress < this.progress){\r\n            progress += dt;\r\n        }\r\n   \r\n        this.progressBar.progress = progress;\r\n   \r\n    },\r\n\r\n    loadnextScene: function() {\r\n        // 登录预加载\r\n        cc.director.preloadScene('login', function () {\r\n            cc.log('登录预加载');\r\n        });\r\n        cc.director.loadScene('login');\r\n    },\r\n\r\n// 　　 changeBj: function(){\r\n// 　　　　var url = 'globalUI/video/gVideoPlayClick';\r\n// 　　　　var _this = this; cc.loader.loadRes(url,cc.SpriteFrame,function(err,spriteFrame)\r\n// 　　　　{ 　\r\n// 　　　　　　_this.isPlay.spriteFrame = spriteFrame;\r\n// 　　　　 });\r\n    \r\n// 　　　\r\n// 　　　　//加载网络图片\r\n//         var url = \"www.monster.com/web/app/loading.jpg\";\r\n//         cc.loader.load({url: url, type: 'png'}, function(err,img){\r\n//             var mylogo  = new cc.SpriteFrame(img); \r\n//             self.logo.spriteFrame = mylogo;\r\n//         });\r\n// 　　　},\r\n});\r\n\r\n\r\n"]}